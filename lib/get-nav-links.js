import flyd from 'flyd'
import R from 'ramda'


// Given a stream of objects generated by getApiData ('./get-api-data.js')
// Turn it into a stream of navigation links like:
// {
//   '/campaigns': [ {path: '/', meth: 'GET'}, {path: '/metrics', meth: 'GET'}]
// , '/nonprofits': [ {path: '/', meth: 'POST'}, {path: '/', meth: 'GET'}]
// }
module.exports = resources =>
  R.mapObjIndexed(
    (res, parent) => 
      R.concat(
        R.map(p => ({parent: parent, meth: 'GET', path: p}), R.sort(R.length, R.keys(res.GET || {})))
      , res.POST ? [{parent, parent, meth: 'POST', path: '/'}] : []
      , res.PATCH ? [{parent, parent, meth: 'PATCH', path: '/'}] : []
      , res.DELETE ? [{parent, parent, meth: 'DELETE', path: '/'}] : []
      )
  , resources )
